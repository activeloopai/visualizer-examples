
var p;

let box_svg = "<svg width=\"185\" height=\"287\" viewBox=\"0 0 185 287\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\
<rect x=\"44\" y=\"4\" width=\"97\" height=\"279\" fill=\"#FFD166\" fill-opacity=\"0.2\" stroke=\"#FFD166\" stroke-width=\"8\"/>\
<g filter=\"url(#filter0_d_205_713)\">\
<mask id=\"path-2-inside-1_205_713\" fill=\"white\">\
<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M57 122C47.6112 122 40 129.611 40 139C40 148.389 47.6112 156 57 156H87.9248L92.5 164L97.0752 156H128C137.389 156 145 148.389 145 139C145 129.611 137.389 122 128 122H57Z\"/>\
</mask>\
<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M57 122C47.6112 122 40 129.611 40 139C40 148.389 47.6112 156 57 156H87.9248L92.5 164L97.0752 156H128C137.389 156 145 148.389 145 139C145 129.611 137.389 122 128 122H57Z\" fill=\"#FFD166\"/>\
<path d=\"M87.9248 156L89.6609 155.007L89.0849 154H87.9248V156ZM92.5 164L90.7639 164.993L92.5 168.029L94.2361 164.993L92.5 164ZM97.0752 156V154H95.9151L95.3391 155.007L97.0752 156ZM42 139C42 130.716 48.7157 124 57 124V120C46.5066 120 38 128.507 38 139H42ZM57 154C48.7157 154 42 147.284 42 139H38C38 149.493 46.5066 158 57 158V154ZM87.9248 154H57V158H87.9248V154ZM94.2361 163.007L89.6609 155.007L86.1886 156.993L90.7639 164.993L94.2361 163.007ZM95.3391 155.007L90.7639 163.007L94.2361 164.993L98.8114 156.993L95.3391 155.007ZM128 154H97.0752V158H128V154ZM143 139C143 147.284 136.284 154 128 154V158C138.493 158 147 149.493 147 139H143ZM128 124C136.284 124 143 130.716 143 139H147C147 128.507 138.493 120 128 120V124ZM57 124H128V120H57V124Z\" fill=\"#212529\" mask=\"url(#path-2-inside-1_205_713)\"/>\
<rect x=\"48\" y=\"128\" width=\"33\" height=\"21\" rx=\"10.5\" fill=\"#212529\"/>\
<path d=\"M65.9525 131.936H63.8946H63.3327L63.0405 132.416L58.4325 139.984L58.2866 140.224V140.504V142.52V143.52H59.2866H64.1106V145V146H65.1106H68.0226H69.0226V145V143.52H69.4786H70.4786V142.52V140.12V139.12H69.4786H69.0226V132.936V131.936H68.0226H66.1106V131.664L65.9525 131.936ZM64.0824 139.12L64.1106 139.072V139.12H64.0824Z\" fill=\"white\" stroke=\"#212529\" stroke-width=\"2\"/>\
<path d=\"M94.4745 140.567L94.4776 140.574L94.4809 140.582C94.5208 140.675 94.544 140.78 94.544 140.908C94.544 141.003 94.5246 141.091 94.4811 141.182L94.4726 141.2L94.4649 141.218C94.4185 141.326 94.3567 141.417 94.2769 141.497L94.2655 141.508L94.2545 141.52C94.1928 141.586 94.1166 141.641 94.0141 141.685C93.9208 141.725 93.8155 141.748 93.688 141.748C93.5698 141.748 93.4609 141.728 93.3554 141.688C93.2369 141.629 93.1387 141.561 93.0561 141.486C92.9816 141.409 92.9234 141.321 92.8791 141.218C92.8392 141.125 92.816 141.02 92.816 140.892C92.816 140.769 92.8377 140.666 92.8753 140.575C92.9371 140.442 93.0062 140.34 93.0785 140.26C93.1556 140.185 93.2428 140.127 93.3459 140.083C93.4392 140.043 93.5445 140.02 93.672 140.02C93.8013 140.02 93.8982 140.045 93.9781 140.083L93.9959 140.091L94.0141 140.099C94.1223 140.146 94.2131 140.207 94.2929 140.287C94.365 140.359 94.4262 140.449 94.4745 140.567ZM91.896 145.988H92.8851C93.3587 146.159 93.8743 146.244 94.424 146.244C95.1415 146.244 95.8256 146.106 96.4639 145.821L96.464 145.821L96.4727 145.817C97.0968 145.531 97.6458 145.142 98.1105 144.651C98.577 144.158 98.9327 143.582 99.1797 142.935C99.4408 142.279 99.568 141.585 99.568 140.86C99.568 140.148 99.447 139.466 99.1976 138.822C98.9537 138.181 98.6073 137.612 98.1528 137.128C97.7041 136.628 97.1592 136.241 96.5323 135.965C95.8889 135.666 95.1915 135.524 94.456 135.524C93.9031 135.524 93.3812 135.609 92.896 135.78V131.708V130.708H91.896H89H88V131.708V144.988V145.988H89H91.896ZM105.115 136.78V135.78H104.115H101.219H100.219V136.78V141.964C100.219 143.31 100.673 144.469 101.699 145.254L101.699 145.254L101.705 145.259C102.689 146 104.035 146.292 105.587 146.292C107.135 146.292 108.48 146.001 109.455 145.256C110.492 144.473 110.955 143.314 110.955 141.964V136.78V135.78H109.955H107.059H106.059V136.78V141.404C106.059 141.58 106.037 141.694 106.015 141.762C105.995 141.825 105.975 141.845 105.972 141.848L105.972 141.848C105.97 141.851 105.956 141.866 105.905 141.883C105.849 141.903 105.749 141.924 105.587 141.924C105.425 141.924 105.324 141.903 105.268 141.883C105.218 141.866 105.204 141.851 105.201 141.848L105.201 141.848L105.201 141.848C105.198 141.845 105.179 141.825 105.158 141.762C105.136 141.694 105.115 141.58 105.115 141.404V136.78ZM112.922 135.78H111.922V136.78V144.988V145.988H112.922H115.818H116.818V144.988V141.468C116.818 140.825 116.959 140.512 117.079 140.367C117.182 140.246 117.372 140.116 117.834 140.116C118.134 140.116 118.396 140.179 118.635 140.298L120.082 141.022V139.404V136.636V135.801L119.261 135.652C119.098 135.623 118.93 135.604 118.762 135.604H118.761H118.761H118.76H118.76H118.759H118.759H118.758H118.758H118.757H118.757H118.756H118.756H118.755H118.755H118.754H118.754H118.753H118.753H118.752H118.752H118.751H118.751H118.75H118.75H118.749H118.749H118.748H118.748H118.747H118.747H118.746H118.746H118.745H118.745H118.744H118.744H118.743H118.743H118.742H118.742H118.741H118.741H118.74H118.74H118.739H118.739H118.739H118.738H118.738H118.737H118.737H118.736H118.736H118.735H118.735H118.734H118.734H118.733H118.733H118.732H118.732H118.731H118.731H118.73H118.73H118.729H118.729H118.728H118.728H118.727H118.727H118.726H118.726H118.725H118.725H118.724H118.724H118.723H118.723H118.722H118.722H118.721H118.721H118.72H118.72H118.719H118.719H118.718H118.718H118.717H118.717H118.716H118.716H118.715H118.715H118.714H118.714H118.713H118.713H118.712H118.712H118.712H118.711H118.711H118.71H118.71H118.709H118.709H118.708H118.708H118.707H118.707H118.706H118.706H118.705H118.705H118.704H118.704H118.703H118.703H118.702H118.702H118.701H118.701H118.7H118.7H118.699H118.699H118.698H118.698H118.697H118.697H118.696H118.696H118.695H118.695H118.695H118.694H118.694H118.693H118.693H118.692H118.692H118.691H118.691H118.69H118.69H118.689H118.689H118.688H118.688H118.687H118.687H118.686H118.686H118.685H118.685H118.684H118.684H118.683H118.683H118.682H118.682H118.682H118.681H118.681H118.68H118.68H118.679H118.679H118.678H118.678H118.677H118.677H118.676H118.676H118.675H118.675H118.674H118.674H118.673H118.673H118.672H118.672H118.671H118.671H118.671H118.67H118.67H118.669H118.669H118.668H118.668H118.667H118.667H118.666H118.666H118.665H118.665H118.664H118.664H118.663H118.663H118.662H118.662H118.661H118.661H118.661H118.66H118.66H118.659H118.659H118.658H118.658H118.657H118.657H118.656H118.656H118.655H118.655H118.654H118.654H118.653H118.653H118.652H118.652H118.652H118.651H118.651H118.65H118.65H118.649H118.649H118.648H118.648H118.647H118.647H118.646H118.646H118.645H118.645H118.644H118.644H118.644H118.643H118.643H118.642H118.642H118.641H118.641H118.64H118.64H118.639H118.639H118.638H118.638H118.637H118.637H118.636H118.636H118.636H118.635H118.635H118.634H118.634H118.633H118.633H118.632H118.632H118.631H118.631H118.63H118.63H118.629H118.629H118.629H118.628H118.628H118.627H118.627H118.626H118.626H118.625H118.625H118.624H118.624H118.623H118.623H118.622H118.622H118.622H118.621H118.621H118.62H118.62H118.619H118.619H118.618H118.618H118.617H118.617H118.616H118.616H118.616H118.615H118.615H118.614H118.614H118.613H118.613H118.612H118.612H118.611H118.611H118.61H118.61H118.61H118.609H118.609H118.608H118.608H118.607H118.607H118.606H118.606H118.605H118.605H118.604H118.604H118.604H118.603H118.603H118.602H118.602H118.601H118.601H118.6H118.6H118.599H118.599H118.598H118.598H118.598H118.597H118.597H118.596H118.596H118.595H118.595H118.594H118.594H118.593H118.593H118.593H118.592H118.592H118.591H118.591H118.59H118.59H118.589H118.589H118.588H118.588H118.588H118.587H118.587H118.586H118.586H118.585H118.585H118.584H118.584H118.583H118.583H118.583H118.582H118.582H118.581H118.581H118.58H118.58H118.579H118.579H118.578H118.578H118.578H118.577H118.577H118.576H118.576H118.575H118.575H118.574H118.574H118.573H118.573H118.573H118.572H118.572H118.571H118.571H118.57H118.57H118.569H118.569H118.568H118.568H118.568H118.567H118.567H118.566H118.566H118.565H118.565H118.564H118.564H118.564H118.563H118.563H118.562H118.562H118.561H118.561H118.56H118.56H118.56H118.559H118.559H118.558H118.558H118.557H118.557H118.556H118.556H118.555H118.555H118.555H118.554H118.554H118.553H118.553H118.552H118.552H118.551H118.551H118.551H118.55H118.55H118.549H118.549H118.548H118.548H118.547H118.547H118.547H118.546H118.546H118.545H118.545H118.544H118.544H118.543H118.543H118.543H118.542H118.542H118.541H118.541H118.54H118.54H118.539H118.539H118.539H118.538H118.538H118.537H118.537H118.536H118.536H118.535H118.535H118.535H118.534H118.534H118.533H118.533H118.532H118.532H118.532H118.531H118.531H118.53H118.53H118.529H118.529H118.528H118.528H118.528H118.527H118.527H118.526H118.526H118.525H118.525H118.525H118.524H118.524H118.523H118.523H118.522H118.522C117.918 135.604 117.344 135.713 116.818 135.95V135.78H115.818H112.922ZM121.375 135.78H120.375V136.78V144.988V145.988H121.375H124.271H125.271V144.988V140.604C125.271 140.207 125.364 140.064 125.402 140.021C125.437 139.982 125.518 139.908 125.791 139.908C125.873 139.908 125.936 139.92 125.987 139.937C125.989 139.937 126 139.94 126.025 139.964C126.025 139.965 126.027 139.968 126.029 139.971C126.035 139.985 126.048 140.016 126.06 140.072L126.065 140.096L126.071 140.12C126.105 140.249 126.135 140.48 126.135 140.844V144.988V145.988H127.135H130.031H131.031V144.988V139.772C131.031 139.272 130.982 138.799 130.873 138.361C130.75 137.867 130.517 137.421 130.187 137.031C129.802 136.574 129.329 136.223 128.781 135.981C128.213 135.716 127.573 135.604 126.895 135.604C126.321 135.604 125.774 135.684 125.271 135.865V135.78H124.271H121.375Z\" fill=\"white\" stroke=\"#212529\" stroke-width=\"2\"/>\
</g>\
<defs>\
<filter id=\"filter0_d_205_713\" x=\"0\" y=\"92\" width=\"185\" height=\"122\" filterUnits=\"userSpaceOnUse\" color-interpolation-filters=\"sRGB\">\
<feFlood flood-opacity=\"0\" result=\"BackgroundImageFix\"/>\
<feColorMatrix in=\"SourceAlpha\" type=\"matrix\" values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\" result=\"hardAlpha\"/>\
<feOffset dy=\"10\"/>\
<feGaussianBlur stdDeviation=\"20\"/>\
<feColorMatrix type=\"matrix\" values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.4 0\"/>\
<feBlend mode=\"normal\" in2=\"BackgroundImageFix\" result=\"effect1_dropShadow_205_713\"/>\
<feBlend mode=\"normal\" in=\"SourceGraphic\" in2=\"effect1_dropShadow_205_713\" result=\"shape\"/>\
</filter>\
</defs>\
</svg>"

let people_svg = "<svg width=\"18\" height=\"19\" viewBox=\"0 0 18 19\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\
<g clip-path=\"url(#clip0_205_761)\">\
<path d=\"M8.99268 1.75C4.85268 1.75 1.49268 5.11 1.49268 9.25C1.49268 13.39 4.85268 16.75 8.99268 16.75C13.1327 16.75 16.4927 13.39 16.4927 9.25C16.4927 5.11 13.1327 1.75 8.99268 1.75V1.75ZM11.7002 6.505C12.5027 6.505 13.1477 7.15 13.1477 7.9525C13.1477 8.755 12.5027 9.4 11.7002 9.4C10.8977 9.4 10.2527 8.755 10.2527 7.9525C10.2452 7.15 10.8977 6.505 11.7002 6.505V6.505ZM7.20018 5.32C8.17518 5.32 8.97018 6.115 8.97018 7.09C8.97018 8.065 8.17518 8.86 7.20018 8.86C6.22518 8.86 5.43018 8.065 5.43018 7.09C5.43018 6.1075 6.21768 5.32 7.20018 5.32ZM7.20018 12.1675V14.98C5.40018 14.4175 3.97518 13.03 3.34518 11.26C4.13268 10.42 6.09768 9.9925 7.20018 9.9925C7.59768 9.9925 8.10018 10.0525 8.62518 10.1575C7.39518 10.81 7.20018 11.6725 7.20018 12.1675ZM8.99268 15.25C8.79018 15.25 8.59518 15.2425 8.40018 15.22V12.1675C8.40018 11.1025 10.6052 10.57 11.7002 10.57C12.5027 10.57 13.8902 10.8625 14.5802 11.4325C13.7027 13.66 11.5352 15.25 8.99268 15.25V15.25Z\" fill=\"#212529\"/>\
</g>\
<defs>\
<clipPath id=\"clip0_205_761\">\
<rect width=\"18\" height=\"18\" fill=\"white\" transform=\"translate(0 0.25)\"/>\
</clipPath>\
</defs>\
</svg>"

let pin_svg = "<svg width=\"36\" height=\"36\" viewBox=\"0 0 36 36\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\
<g clip-path=\"url(#clip0_205_758)\">\
<path d=\"M13.5064 27.889L13.5076 27.891C14.1768 28.9588 14.6648 29.9606 15.1962 31.1561L15.2009 31.1668L15.2059 31.1774C15.2631 31.2983 15.3146 31.4259 15.3796 31.5872C15.4092 31.6606 15.4416 31.7409 15.4787 31.8307C15.5855 32.0898 15.7215 32.4023 15.8994 32.6989C16.2593 33.2987 16.9024 34 18 34C19.0977 34 19.7413 33.2987 20.1003 32.6963C20.2778 32.3985 20.4124 32.085 20.5177 31.824C20.5589 31.722 20.594 31.6328 20.6257 31.552C20.6844 31.4025 20.7316 31.2822 20.7849 31.1647C21.3381 29.9538 21.81 28.956 22.4771 27.8915C23.1513 26.8169 23.9285 25.8089 24.7419 24.7541L24.7976 24.6818C25.6199 23.6153 26.4761 22.4999 27.2201 21.2866C28.6915 18.9341 29.5 16.3082 29.5 13.5C29.5 7.14272 24.3573 2 18 2C11.6427 2 6.5 7.14272 6.5 13.5C6.5 16.3089 7.3089 18.9341 8.76391 21.285C9.5081 22.4914 10.3652 23.6041 11.1874 24.6706L11.1995 24.6863C12.0277 25.7604 12.8206 26.7889 13.5064 27.889Z\" fill=\"#FFD166\" stroke=\"#212529\" stroke-width=\"2\"/>\
<g clip-path=\"url(#clip1_205_758)\">\
<path d=\"M17.9927 6.75C13.8527 6.75 10.4927 10.11 10.4927 14.25C10.4927 18.39 13.8527 21.75 17.9927 21.75C22.1327 21.75 25.4927 18.39 25.4927 14.25C25.4927 10.11 22.1327 6.75 17.9927 6.75V6.75ZM20.7002 11.505C21.5027 11.505 22.1477 12.15 22.1477 12.9525C22.1477 13.755 21.5027 14.4 20.7002 14.4C19.8977 14.4 19.2527 13.755 19.2527 12.9525C19.2452 12.15 19.8977 11.505 20.7002 11.505V11.505ZM16.2002 10.32C17.1752 10.32 17.9702 11.115 17.9702 12.09C17.9702 13.065 17.1752 13.86 16.2002 13.86C15.2252 13.86 14.4302 13.065 14.4302 12.09C14.4302 11.1075 15.2177 10.32 16.2002 10.32ZM16.2002 17.1675V19.98C14.4002 19.4175 12.9752 18.03 12.3452 16.26C13.1327 15.42 15.0977 14.9925 16.2002 14.9925C16.5977 14.9925 17.1002 15.0525 17.6252 15.1575C16.3952 15.81 16.2002 16.6725 16.2002 17.1675ZM17.9927 20.25C17.7902 20.25 17.5952 20.2425 17.4002 20.22V17.1675C17.4002 16.1025 19.6052 15.57 20.7002 15.57C21.5027 15.57 22.8902 15.8625 23.5802 16.4325C22.7027 18.66 20.5352 20.25 17.9927 20.25V20.25Z\" fill=\"#212529\"/>\
</g>\
</g>\
<defs>\
<clipPath id=\"clip0_205_758\">\
<rect width=\"36\" height=\"36\" fill=\"white\"/>\
</clipPath>\
<clipPath id=\"clip1_205_758\">\
<rect width=\"18\" height=\"18\" fill=\"white\" transform=\"translate(9 5.25)\"/>\
</clipPath>\
</defs>\
</svg>"

function constructVis() {
  let container = document.getElementById('container')
  path = "hub://activeloop/rembrandt"

  p = window.vis.visualize(path, null, null, container, { controlPanel: false, backlink: false, token: null })

  p.then(e => {
    e.engine.darkMode = true
    e.engine.renderingOption = "simplified"

    const Anchor = window.vis.Anchor

    let boxes = []
    boxes.push(e.addSvg(box_svg, 0, { coord: { x: .5, y: .47 }, anchor: Anchor.bottom }, { x: 1, y: .12 }));
    boxes.push(e.addSvg(box_svg, 0, { coord: { x: .6, y: .47 }, anchor: Anchor.bottom }, { x: 1, y: .12 }));
    boxes.push(e.addSvg(box_svg, 0, { coord: { x: .7, y: .47 }, anchor: Anchor.bottom }, { x: 1, y: .12 }));
    boxes.push(e.addSvg(box_svg, 0, { coord: { x: .35, y: .83 }, anchor: Anchor.bottom }, { x: 1, y: .12 }));
    boxes.push(e.addSvg(box_svg, 0, { coord: { x: .45, y: .83 }, anchor: Anchor.bottom }, { x: 1, y: .12 }));
    boxes.push(e.addSvg(box_svg, 0, { coord: { x: .55, y: .83 }, anchor: Anchor.bottom }, { x: 1, y: .12 }));

    let box_hs = document.getElementById("boxes_hs");
    box_hs.onclick = () => {
      for (let box of boxes) {
        box.hidden = !box.hidden
      }
    }

    let peoples = []
    peoples.push(e.addSvg(people_svg, 0, { coord: { x: .35, y: .47 }, anchor: Anchor.bottom }, { x: 1, y: .12 }))
    peoples.push(e.addSvg(people_svg, 0, { coord: { x: .5, y: .65 }, anchor: Anchor.bottom }, { x: 1, y: .12 }))
    peoples.push(e.addSvg(people_svg, 0, { coord: { x: .65, y: .83 }, anchor: Anchor.bottom }, { x: 1, y: .12 }))

    let peop_hs = document.getElementById("peoples_hs");
    peop_hs.onclick = () => {
      for (let people of peoples) {
        people.hidden = !people.hidden
      }
    }

    let pins = []
    e.engine.onClick = (i) => {
      if (i >= 0) {
        pins.push(e.addSvg(pin_svg, i, { coord: e.getHoverCoord(i), anchor: Anchor.bottom }, { x: .1, y: .1 }))
      }
    }

    let pin_hs = document.getElementById("pins_hs");
    pin_hs.onclick = () => {
      for (let pin of pins) {
        pin.hidden = !pin.hidden
      }
    }

    const update = () => {
      if (e.scale > 3.0) {
        e.setTensorHidden("detailed_bboxes", false)
        e.setTensorHidden("bboxes", true)
      } else {
        e.setTensorHidden("detailed_bboxes", true)
        e.setTensorHidden("bboxes", false)
      }
      requestAnimationFrame(update)
    }
    requestAnimationFrame(update)
  })
}
